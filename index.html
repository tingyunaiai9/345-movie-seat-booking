<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”µå½±é™¢åœ¨çº¿é€‰åº§ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- é¡µé¢å¤´éƒ¨ -->
    <header class="header">
        <div class="container">
            <h1 class="logo">ğŸ¬ ç”µå½±é™¢é€‰åº§ç³»ç»Ÿ</h1>
            <nav class="nav">
                <div class="nav-steps">
                    <span class="step active" data-step="config">å½±å…é…ç½®</span>
                    <span class="step" data-step="movie">ç”µå½±é€‰æ‹©</span>
                    <span class="step" data-step="seat">é€‰åº§</span>
                    <span class="step" data-step="payment">æ”¯ä»˜</span>
                    <span class="step" data-step="confirm">ç¡®è®¤</span>
                </div>
            </nav>
        </div>
    </header>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="main">
        <div class="container">
            
            <!-- é…ç½®è§†å›¾ -->
            <section id="config-view" class="view active">
                <div class="config-panel">
                    <h2>å½±å…é…ç½®</h2>
                    <div class="config-section">
                        <h3>é€‰æ‹©å½±å…è§„æ¨¡</h3>
                        <div class="preset-options">
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="small">
                                <span class="preset-info">
                                    <strong>å°å…</strong>
                                    <span class="preset-details">8æ’ Ã— 15åº§ = 120ä¸ªåº§ä½</span>
                                </span>
                            </label>
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="medium" checked>
                                <span class="preset-info">
                                    <strong>ä¸­å…</strong>
                                    <span class="preset-details">10æ’ Ã— 20åº§ = 200ä¸ªåº§ä½</span>
                                </span>
                            </label>
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="large">
                                <span class="preset-info">
                                    <strong>å¤§å…</strong>
                                    <span class="preset-details">12æ’ Ã— 25åº§ = 300ä¸ªåº§ä½</span>
                                </span>
                            </label>
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="custom">
                                <span class="preset-info">
                                    <strong>è‡ªå®šä¹‰</strong>
                                    <span class="preset-details">è‡ªå®šä¹‰å½±å…å¤§å°</span>
                                </span>
                            </label>
                        </div>
                    </div>

                    <div class="config-section custom-config" style="display: none;">
                        <h3>è‡ªå®šä¹‰é…ç½®</h3>
                        <div class="custom-inputs">
                            <div class="input-group">
                                <label for="custom-rows">æ’æ•°:</label>
                                <input type="number" id="custom-rows" min="5" max="20" value="10">
                                <span class="input-hint">å»ºè®®5-20æ’</span>
                            </div>
                            <div class="input-group">
                                <label for="custom-seats">æ¯æ’åº§ä½æ•°:</label>
                                <input type="number" id="custom-seats" min="10" max="30" value="20">
                                <span class="input-hint">å»ºè®®10-30åº§</span>
                            </div>
                            <div class="total-info">
                                æ€»åº§ä½æ•°: <span id="total-seats">200</span>
                            </div>
                        </div>
                    </div>

                    <div class="config-actions">
                        <button class="btn btn-primary" id="next-to-movie">ä¸‹ä¸€æ­¥ï¼šé€‰æ‹©ç”µå½±</button>
                    </div>
                </div>
            </section>

            <!-- ç”µå½±é€‰æ‹©è§†å›¾ -->
            <section id="movie-view" class="view">
                <div class="movie-panel">
                    <h2>é€‰æ‹©ç”µå½±</h2>
                    <div class="movie-list">
                        <div class="movie-item active" data-movie="luoxiaohei">
                            <img src="img/LUOXIAOHEI.webp" alt="ç½—å°é»‘æˆ˜è®°">
                            <div class="movie-info">
                                <h3>ç½—å°é»‘æˆ˜è®°</h3>
                                <p class="movie-time">2025-6-1 19:30</p>
                                <p class="movie-price">ç¥¨ä»·: Â¥45</p>
                            </div>
                        </div>
                        <div class="movie-item" data-movie="look_back">
                            <img src="img/OIP.jpg" alt="è“¦ç„¶å›é¦–">
                            <div class="movie-info">
                                <h3>è“¦ç„¶å›é¦–</h3>
                                <p class="movie-time">2025-6-30 21:00</p>
                                <p class="movie-price">ç¥¨ä»·: Â¥50</p>
                            </div>
                        </div>
                        <div class="movie-item" data-movie="love_letter">
                            <img src="img/OIP.webp" alt="æƒ…ä¹¦">
                            <div class="movie-info">
                                <h3>æƒ…ä¹¦</h3>
                                <p class="movie-time">2025-5-20 17:20</p>
                                <p class="movie-price">ç¥¨ä»·: Â¥45</p>
                            </div>
                        </div>
                    </div>
                    <div class="movie-actions">
                        <button class="btn btn-secondary" id="back-to-config">ä¸Šä¸€æ­¥</button>
                        <button class="btn btn-primary" id="next-to-seat">ä¸‹ä¸€æ­¥ï¼šé€‰æ‹©åº§ä½</button>
                    </div>
                </div>
            </section>

            <!-- é€‰åº§è§†å›¾ -->
            <section id="seat-view" class="view">
                <div class="seat-panel">
                    <div class="seat-header">
                        <h2>é€‰æ‹©åº§ä½</h2>
                        <div class="ticket-type-selector">
                            <label class="ticket-type active">
                                <input type="radio" name="ticket-type" value="individual" checked>
                                <span>ä¸ªäººç¥¨</span>
                            </label>
                            <label class="ticket-type">
                                <input type="radio" name="ticket-type" value="group">
                                <span>å›¢ä½“ç¥¨</span>
                            </label>
                        </div>
                    </div>

                    <div class="seat-content">
                        <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
                        <div class="seat-controls">
                            <!-- ä¸ªäººç¥¨æ§åˆ¶ -->
                            <div class="individual-controls">
                                <div class="customer-info">
                                    <h3>å®¢æˆ·ä¿¡æ¯</h3>
                                    <div class="input-group">
                                        <label for="customer-name">å§“å:</label>
                                        <input type="text" id="customer-name" placeholder="è¯·è¾“å…¥å§“å">
                                    </div>
                                    <div class="input-group">
                                        <label for="customer-age">å¹´é¾„:</label>
                                        <input type="number" id="customer-age" min="1" max="120" value="25">
                                    </div>
                                    <div class="input-group">
                                        <label for="customer-phone">æ‰‹æœºå·:</label>
                                        <input type="tel" id="customer-phone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·">
                                    </div>
                                </div>

                                <div class="seat-preference">
                                    <h3>é€‰åº§åå¥½</h3>
                                    <select id="seat-preference">
                                        <option value="auto">è‡ªåŠ¨æ¨è</option>
                                        <option value="front">å‰æ’</option>
                                        <option value="middle">ä¸­é—´</option>
                                        <option value="back">åæ’</option>
                                    </select>
                                </div>

                                <div class="auto-seat-actions">
                                    <button class="btn btn-auto" id="auto-select-individual">è‡ªåŠ¨é€‰åº§</button>
                                </div>
                            </div>

                            <!-- å›¢ä½“ç¥¨æ§åˆ¶ -->
                            <div class="group-controls" style="display: none;">
                                <div class="group-info">
                                    <h3>å›¢ä½“ä¿¡æ¯</h3>
                                    <div class="group-members">
                                        <div class="member-list">
                                            <!-- åŠ¨æ€ç”Ÿæˆå›¢ä½“æˆå‘˜åˆ—è¡¨ -->
                                        </div>
                                        <div class="add-member">
                                            <div class="input-row">
                                                <div class="input-container">
                                                    <input type="text" id="member-name" placeholder="æˆå‘˜å§“å">
                                                    <input type="number" id="member-age" placeholder="å¹´é¾„" min="1" max="120">
                                                </div>
                                                <button class="btn btn-add" id="add-member">æ·»åŠ </button>
                                            </div>
                                            <div class="member-count">
                                                å·²æ·»åŠ  <span id="member-count">0</span> äºº (æœ€å¤š20äºº)
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="group-preference">
                                    <h3>é€‰åº§åå¥½</h3>
                                    <select id="group-preference">
                                        <option value="auto">è‡ªåŠ¨æ¨è</option>
                                        <option value="front">å‰æ’</option>
                                        <option value="middle">ä¸­é—´</option>
                                        <option value="back">åæ’</option>
                                    </select>
                                </div>

                                <div class="auto-seat-actions">
                                    <button class="btn btn-auto" id="auto-select-group">å›¢ä½“è‡ªåŠ¨é€‰åº§</button>
                                </div>
                            </div>

                            <!-- æ‰‹åŠ¨é€‰åº§æ¨¡å¼åˆ‡æ¢ -->
                            <div class="manual-controls">
                                <h3>æ‰‹åŠ¨é€‰åº§</h3>
                                <div class="manual-options">
                                    <label class="manual-option">
                                        <input type="radio" name="manual-mode" value="single" checked>
                                        <span>å•é€‰æ¨¡å¼</span>
                                    </label>
                                    <label class="manual-option">
                                        <input type="radio" name="manual-mode" value="multi">
                                        <span>å¤šé€‰æ¨¡å¼ (Ctrl+ç‚¹å‡»)</span>
                                    </label>
                                </div>
                                <button class="btn btn-clear" id="clear-selection">æ¸…é™¤é€‰æ‹©</button>
                            </div>

                            <!-- å·²é€‰åº§ä½ä¿¡æ¯ -->
                            <div class="selected-seats">
                                <h3>å·²é€‰åº§ä½</h3>
                                <div class="selected-list" id="selected-seats-list">
                                    <p class="no-selection">æš‚æœªé€‰æ‹©åº§ä½</p>
                                </div>
                                <div class="selection-summary">
                                    <div class="summary-item">
                                        <span>å·²é€‰åº§ä½æ•°:</span>
                                        <span id="selected-count">0</span>
                                    </div>
                                    <div class="summary-item">
                                        <span>æ€»é‡‘é¢:</span>
                                        <span id="total-price">Â¥0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ä¸­é—´Canvasåº§ä½å›¾åŒºåŸŸ -->
                        <div class="seat-canvas-area">
                            <div class="seat-canvas-container">
                                <div class="screen">
                                    <div class="screen-label">é“¶å¹•</div>
                                </div>
                                <canvas id="cinema-canvas" width="800" height="500">
                                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒCanvasï¼Œè¯·å‡çº§æµè§ˆå™¨
                                </canvas>
                                <div class="legend">
                                    <div class="legend-item">
                                        <span class="legend-color available"></span>
                                        <span>å¯é€‰åº§ä½</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color selected"></span>
                                        <span>å·²é€‰åº§ä½</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color sold"></span>
                                        <span>å·²å”®åº§ä½</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color reserved"></span>
                                        <span>å·²é¢„è®¢</span>
                                    </div>
                                </div>
                            </div>

                            <!-- åº§ä½æ“ä½œé¢æ¿ç§»åˆ°Canvasä¸‹æ–¹ -->
                            <div class="seat-operations-bottom">
                                <div class="operations-grid">
                                    <div class="operations-section">
                                        <h3>åº§ä½æ“ä½œ</h3>
                                        <div class="operation-buttons">
                                            <button class="btn btn-reserve" id="reserve-seats">é¢„è®¢åº§ä½</button>
                                            <button class="btn btn-purchase" id="purchase-seats">ç›´æ¥è´­ç¥¨</button>
                                        </div>
                                    </div>

                                    <div class="operations-section">
                                        <h3>å½±å…çŠ¶æ€</h3>
                                        <div class="cinema-stats" id="cinema-stats">
                                            <div class="stat-item">
                                                <span>å¯é€‰åº§ä½:</span>
                                                <span id="available-count">200</span>
                                            </div>
                                            <div class="stat-item">
                                                <span>å·²å”®åº§ä½:</span>
                                                <span id="sold-count">0</span>
                                            </div>
                                            <div class="stat-item">
                                                <span>å·²é¢„è®¢:</span>
                                                <span id="reserved-count">0</span>
                                            </div>
                                            <div class="stat-item">
                                                <span>ä¸Šåº§ç‡:</span>
                                                <span id="occupancy-rate">0%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="seat-actions">
                        <button class="btn btn-secondary" id="back-to-movie">ä¸Šä¸€æ­¥</button>
                        <button class="btn btn-primary" id="next-to-payment" disabled>ä¸‹ä¸€æ­¥ï¼šæ”¯ä»˜ç¡®è®¤</button>
                    </div>
                </div>
            </section>

            <!-- æ”¯ä»˜è§†å›¾ -->
            <section id="payment-view" class="view">
                <div class="payment-panel">
                    <h2>æ”¯ä»˜ç¡®è®¤</h2>
                    <div class="payment-content">
                        <div class="order-summary">
                            <h3>è®¢å•è¯¦æƒ…</h3>
                            <div class="movie-info-summary">
                                <div class="movie-poster">
                                    <img src="https://via.placeholder.com/100x150?text=ç”µå½±æµ·æŠ¥" alt="ç”µå½±æµ·æŠ¥">
                                </div>
                                <div class="movie-details">
                                    <h4 id="payment-movie-title">å¤ä»‡è€…è”ç›Ÿï¼šç»ˆå±€ä¹‹æˆ˜</h4>
                                    <p id="payment-movie-time">2024-12-25 19:30</p>
                                    <p id="payment-cinema-info">ä¸­å… (10æ’Ã—20åº§)</p>
                                </div>
                            </div>
                            
                            <div class="seats-summary">
                                <h4>é€‰ä¸­åº§ä½</h4>
                                <div id="payment-seats-list">
                                    <!-- åŠ¨æ€ç”Ÿæˆåº§ä½åˆ—è¡¨ -->
                                </div>
                            </div>

                            <div class="price-breakdown">
                                <div class="price-item">
                                    <span>ç¥¨ä»·:</span>
                                    <span id="unit-price">Â¥45</span>
                                </div>
                                <div class="price-item">
                                    <span>æ•°é‡:</span>
                                    <span id="ticket-quantity">1</span>
                                </div>
                                <div class="price-item total">
                                    <span>æ€»è®¡:</span>
                                    <span id="final-total">Â¥45</span>
                                </div>
                            </div>
                        </div>

                        <div class="payment-method">
                            <h3>æ”¯ä»˜æ–¹å¼</h3>
                            <div class="payment-options">
                                <label class="payment-option active">
                                    <input type="radio" name="payment-method" value="wechat" checked>
                                    <span class="payment-icon">ğŸ’³</span>
                                    <span>å¾®ä¿¡æ”¯ä»˜</span>
                                </label>
                                <label class="payment-option">
                                    <input type="radio" name="payment-method" value="alipay">
                                    <span class="payment-icon">ğŸ’°</span>
                                    <span>æ”¯ä»˜å®</span>
                                </label>
                                <label class="payment-option">
                                    <input type="radio" name="payment-method" value="card">
                                    <span class="payment-icon">ğŸ’³</span>
                                    <span>é“¶è¡Œå¡</span>
                                </label>
                            </div>
                        </div>

                        <div class="customer-summary">
                            <h3>å®¢æˆ·ä¿¡æ¯</h3>
                            <div id="payment-customer-info">
                                <!-- åŠ¨æ€ç”Ÿæˆå®¢æˆ·ä¿¡æ¯ -->
                            </div>
                        </div>
                    </div>

                    <div class="payment-actions">
                        <button class="btn btn-secondary" id="back-to-seat">è¿”å›é€‰åº§</button>
                        <button class="btn btn-success" id="confirm-payment">ç¡®è®¤æ”¯ä»˜</button>
                    </div>
                </div>
            </section>

            <!-- ç¡®è®¤è§†å›¾ -->
            <section id="confirm-view" class="view">
                <div class="confirm-panel">
                    <div class="confirm-header">
                        <h2>ç¡®è®¤è®¢å•</h2>
                        <p class="subtitle">è¯·ç¡®è®¤æ‚¨çš„è®¢ç¥¨ä¿¡æ¯</p>
                    </div>

                    <div class="order-details">
                        <div class="detail-section">
                            <h3>ç”µå½±ä¿¡æ¯</h3>
                            <div class="detail-item">
                                <span class="label">ç”µå½±åç§°:</span>
                                <span class="value" id="confirm-movie-title">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="label">æ”¾æ˜ æ—¶é—´:</span>
                                <span class="value" id="confirm-showtime">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="label">å½±å…:</span>
                                <span class="value" id="confirm-cinema">-</span>
                            </div>
                        </div>

                        <div class="detail-section">
                            <h3>å®¢æˆ·ä¿¡æ¯</h3>
                            <div class="detail-item">
                                <span class="label">å§“å:</span>
                                <span class="value" id="confirm-customer-name">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="label">ç”µè¯:</span>
                                <span class="value" id="confirm-customer-phone">-</span>
                            </div>
                            <div class="detail-item">
                                <span class="label">ç¥¨åŠ¡ç±»å‹:</span>
                                <span class="value" id="confirm-ticket-type">-</span>
                            </div>
                        </div>

                        <div class="seat-info">
                            <h3>åº§ä½ä¿¡æ¯</h3>
                            <div class="seat-list" id="confirm-seat-list">
                                <!-- åº§ä½ä¿¡æ¯å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                            </div>
                        </div>

                        <div class="cost-breakdown">
                            <h3>è´¹ç”¨æ˜ç»†</h3>
                            <div class="cost-item">
                                <span class="label">ç¥¨ä»· Ã— æ•°é‡:</span>
                                <span class="amount" id="ticket-cost">Â¥0</span>
                            </div>
                            <div class="cost-item">
                                <span class="label">æœåŠ¡è´¹:</span>
                                <span class="amount" id="service-fee">Â¥0</span>
                            </div>
                            <div class="cost-item">
                                <span class="label">æ€»è®¡:</span>
                                <span class="amount" id="total-cost">Â¥0</span>
                            </div>
                        </div>
                    </div>

                    <div class="payment-methods">
                        <h3>é€‰æ‹©æ”¯ä»˜æ–¹å¼</h3>
                        <div class="payment-options">
                            <label class="payment-option">
                                <input type="radio" name="payment-method" value="alipay">
                                <div class="payment-icon alipay">ğŸ’³</div>
                                <div class="payment-info">
                                    <div class="payment-name">æ”¯ä»˜å®</div>
                                    <div class="payment-desc">å®‰å…¨ä¾¿æ·çš„ç§»åŠ¨æ”¯ä»˜</div>
                                </div>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-method" value="wechat">
                                <div class="payment-icon wechat">ğŸ’š</div>
                                <div class="payment-info">
                                    <div class="payment-name">å¾®ä¿¡æ”¯ä»˜</div>
                                    <div class="payment-desc">å¿«é€Ÿæ‰«ç æ”¯ä»˜</div>
                                </div>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-method" value="card">
                                <div class="payment-icon card">ğŸ’³</div>
                                <div class="payment-info">
                                    <div class="payment-name">é“¶è¡Œå¡</div>
                                    <div class="payment-desc">å€Ÿè®°å¡/ä¿¡ç”¨å¡æ”¯ä»˜</div>
                                </div>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-method" value="cash">
                                <div class="payment-icon cash">ğŸ’°</div>
                                <div class="payment-info">
                                    <div class="payment-name">ç°é‡‘æ”¯ä»˜</div>
                                    <div class="payment-desc">ç°åœºå–ç¥¨ä»˜æ¬¾</div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="confirm-actions">
                        <button class="btn btn-back" id="back-to-seat">è¿”å›é€‰åº§</button>
                        <button class="btn btn-pay" id="confirm-payment" disabled>ç¡®è®¤æ”¯ä»˜</button>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- æ¶ˆæ¯æç¤ºç»„ä»¶ -->
    <div class="message-container" id="message-container">
        <!-- åŠ¨æ€ç”Ÿæˆæ¶ˆæ¯æç¤º -->
    </div>

    <!-- åŠ è½½çŠ¶æ€é®ç½© -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p class="loading-text">æ­£åœ¨åŠ è½½...</p>
        </div>
    </div>

    <!-- ç¡®è®¤å¯¹è¯æ¡† -->
    <div class="modal-overlay" id="modal-overlay" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 id="modal-title">ç¡®è®¤æ“ä½œ</h3>
                <button class="modal-close" id="modal-close">Ã—</button>
            </div>
            <div class="modal-body">
                <p id="modal-message">ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modal-cancel">å–æ¶ˆ</button>
                <button class="btn btn-primary" id="modal-confirm">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <!-- é¡µé¢åº•éƒ¨ -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 ç”µå½±é™¢é€‰åº§ç³»ç»Ÿ - åŸºäºCanvasæŠ€æœ¯å®ç°</p>
        </div>
    </footer>

    <!-- å¼•å…¥JavaScriptæ¨¡å— -->
    <script src="js/movieSelector.js"></script>
    <script src="js/viewController.js"></script>
    <script src="js/main.js"></script>
    <script src="js/canvas.js"></script>
    <script src="js/stateManager.js"></script>
    <script src="js/ui.js"></script>
    <!-- ç¥¨åŠ¡ç±»å‹åˆ‡æ¢åŠŸèƒ½ -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œåˆå§‹åŒ–æ‰€æœ‰åŠŸèƒ½');
        
        // ç¥¨åŠ¡ç±»å‹åˆ‡æ¢åŠŸèƒ½
        const ticketTypes = document.querySelectorAll('.ticket-type');
        const individualControls = document.querySelector('.individual-controls');
        const groupControls = document.querySelector('.group-controls');
        
        ticketTypes.forEach((ticketType, index) => {
            ticketType.addEventListener('click', function() {
                console.log(`ç‚¹å‡»äº†ç¥¨åŠ¡ç±»å‹ ${index}`);
                
                // ç§»é™¤æ‰€æœ‰activeç±»
                ticketTypes.forEach(type => type.classList.remove('active'));
                
                // æ·»åŠ activeç±»åˆ°å½“å‰ç‚¹å‡»çš„ç±»å‹
                this.classList.add('active');
                
                // è·å–é€‰ä¸­çš„ç¥¨åŠ¡ç±»å‹
                const radioButton = this.querySelector('input[type="radio"]');
                if (radioButton) {
                    radioButton.checked = true;
                    const ticketType = radioButton.value;
                    console.log('é€‰ä¸­çš„ç¥¨åŠ¡ç±»å‹:', ticketType);
                    
                    // æ ¹æ®ç¥¨åŠ¡ç±»å‹æ˜¾ç¤ºå¯¹åº”çš„æ§åˆ¶é¢æ¿
                    if (ticketType === 'individual') {
                        showIndividualControls();
                    } else if (ticketType === 'group') {
                        showGroupControls();
                    }
                }
            });
        });
        
        // æ˜¾ç¤ºä¸ªäººç¥¨æ§åˆ¶é¢æ¿
        function showIndividualControls() {
            console.log('æ˜¾ç¤ºä¸ªäººç¥¨æ§åˆ¶é¢æ¿');
            if (individualControls && groupControls) {
                individualControls.style.display = 'block';
                individualControls.classList.add('active');
                individualControls.classList.remove('hidden');
                
                groupControls.style.display = 'none';
                groupControls.classList.add('hidden');
                groupControls.classList.remove('active');
            }
        }
        
        // æ˜¾ç¤ºå›¢ä½“ç¥¨æ§åˆ¶é¢æ¿
        function showGroupControls() {
            console.log('æ˜¾ç¤ºå›¢ä½“ç¥¨æ§åˆ¶é¢æ¿');
            if (individualControls && groupControls) {
                individualControls.style.display = 'none';
                individualControls.classList.add('hidden');
                individualControls.classList.remove('active');
                
                groupControls.style.display = 'block';
                groupControls.classList.add('active');
                groupControls.classList.remove('hidden');
            }
        }
        
        // å›¢ä½“æˆå‘˜ç®¡ç†åŠŸèƒ½
        let memberCount = 0;
        const maxMembers = 20;
        const memberList = document.querySelector('.member-list');
        const addMemberBtn = document.getElementById('add-member');
        const memberNameInput = document.getElementById('member-name');
        const memberAgeInput = document.getElementById('member-age');
        const memberCountSpan = document.getElementById('member-count');
        
        if (addMemberBtn) {
            addMemberBtn.addEventListener('click', function() {
                const name = memberNameInput.value.trim();
                const age = memberAgeInput.value.trim();
                
                if (!name) {
                    alert('è¯·è¾“å…¥æˆå‘˜å§“å');
                    return;
                }
                
                if (!age || age < 1 || age > 120) {
                    alert('è¯·è¾“å…¥æœ‰æ•ˆå¹´é¾„ï¼ˆ1-120ï¼‰');
                    return;
                }
                
                if (memberCount >= maxMembers) {
                    alert(`æœ€å¤šåªèƒ½æ·»åŠ ${maxMembers}åæˆå‘˜`);
                    return;
                }
                
                // æ·»åŠ æˆå‘˜åˆ°åˆ—è¡¨
                addMemberToList(name, age);
                
                // æ¸…ç©ºè¾“å…¥æ¡†
                memberNameInput.value = '';
                memberAgeInput.value = '';
                
                // æ›´æ–°è®¡æ•°
                memberCount++;
                updateMemberCount();
            });
        }
        
        function addMemberToList(name, age) {
            const memberItem = document.createElement('div');
            memberItem.className = 'member-item';
            memberItem.innerHTML = `
                <div class="member-info">
                    <span class="member-name">${name}</span>
                    <span class="member-age">${age}å²</span>
                </div>
                <button class="remove-member" onclick="removeMember(this)">åˆ é™¤</button>
            `;
            memberList.appendChild(memberItem);
        }
        
        // åˆ é™¤æˆå‘˜å‡½æ•°ï¼ˆå…¨å±€ï¼‰
        window.removeMember = function(button) {
            const memberItem = button.parentElement;
            memberItem.remove();
            memberCount--;
            updateMemberCount();
        };
        
        function updateMemberCount() {
            if (memberCountSpan) {
                memberCountSpan.textContent = memberCount;
            }
        }
        
        // é¡µé¢è·³è½¬åŠŸèƒ½
        function showView(viewId) {
            // éšè—æ‰€æœ‰è§†å›¾
            const views = document.querySelectorAll('.view');
            views.forEach(view => {
                view.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡è§†å›¾
            const targetView = document.getElementById(viewId);
            if (targetView) {
                targetView.classList.add('active');
                console.log('è·³è½¬åˆ°è§†å›¾:', viewId);
            }
        }
        
        // ===== æ·»åŠ æ‰€æœ‰é¡µé¢è·³è½¬æŒ‰é’®çš„äº‹ä»¶ç›‘å¬å™¨ =====
        
        // é…ç½®é¡µé¢ -> ç”µå½±é€‰æ‹©
        const nextToMovieBtn = document.getElementById('next-to-movie');
        if (nextToMovieBtn) {
            nextToMovieBtn.addEventListener('click', function() {
                showView('movie-view');
            });
        }
        
        // ç”µå½±é€‰æ‹© -> é€‰åº§é¡µé¢
        const nextToSeatBtn = document.getElementById('next-to-seat');
        if (nextToSeatBtn) {
            nextToSeatBtn.addEventListener('click', function() {
                showView('seat-view');
            });
        }
        
        // é€‰åº§é¡µé¢ -> æ”¯ä»˜é¡µé¢
        const nextToPaymentBtn = document.getElementById('next-to-payment');
        if (nextToPaymentBtn) {
            // ç§»é™¤disabledå±æ€§ï¼Œè®©æŒ‰é’®å¯ä»¥ç‚¹å‡»
            nextToPaymentBtn.disabled = false;
            nextToPaymentBtn.addEventListener('click', function() {
                console.log('è·³è½¬åˆ°æ”¯ä»˜é¡µé¢');
                showView('payment-view');
            });
        }
        
        // æ”¯ä»˜é¡µé¢ -> ç¡®è®¤é¡µé¢
        const confirmPaymentBtn = document.getElementById('confirm-payment');
        if (confirmPaymentBtn) {
            // ç§»é™¤disabledå±æ€§ï¼Œè®©æŒ‰é’®å¯ä»¥ç‚¹å‡»
            confirmPaymentBtn.disabled = false;
            confirmPaymentBtn.addEventListener('click', function() {
                console.log('è·³è½¬åˆ°ç¡®è®¤é¡µé¢');
                showView('confirm-view');
            });
        }
        
        // ç¡®è®¤é¡µé¢çš„æ”¯ä»˜æŒ‰é’®
        const confirmPayBtn = document.querySelector('#confirm-view .btn-pay');
        if (confirmPayBtn) {
            // ç§»é™¤disabledå±æ€§ï¼Œè®©æŒ‰é’®å¯ä»¥ç‚¹å‡»
            confirmPayBtn.disabled = false;
            confirmPayBtn.addEventListener('click', function() {
                alert('æ”¯ä»˜æˆåŠŸï¼è®¢å•å·²ç¡®è®¤ã€‚');
                // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è·³è½¬åˆ°æˆåŠŸé¡µé¢çš„é€»è¾‘
                console.log('æ”¯ä»˜å®Œæˆ');
            });
        }
        
        // è¿”å›æŒ‰é’®ä»¬
        const backToConfigBtn = document.getElementById('back-to-config');
        if (backToConfigBtn) {
            backToConfigBtn.addEventListener('click', function() {
                showView('config-view');
            });
        }
        
        const backToMovieBtn = document.getElementById('back-to-movie');
        if (backToMovieBtn) {
            backToMovieBtn.addEventListener('click', function() {
                showView('movie-view');
            });
        }
        
        const backToSeatBtns = document.querySelectorAll('#back-to-seat');
        backToSeatBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                showView('seat-view');
            });
        });
        
        // æ”¯ä»˜æ–¹å¼é€‰æ‹©åŠŸèƒ½
        const paymentOptions = document.querySelectorAll('.payment-option');
        paymentOptions.forEach(option => {
            option.addEventListener('click', function() {
                // ç§»é™¤æ‰€æœ‰activeç±»
                const allOptions = this.parentElement.querySelectorAll('.payment-option');
                allOptions.forEach(opt => opt.classList.remove('active'));
                
                // æ·»åŠ activeç±»åˆ°å½“å‰é€‰é¡¹
                this.classList.add('active');
                
                // é€‰ä¸­å¯¹åº”çš„radioæŒ‰é’®
                const radio = this.querySelector('input[type="radio"]');
                if (radio) {
                    radio.checked = true;
                }
                
                console.log('é€‰æ‹©æ”¯ä»˜æ–¹å¼:', radio ? radio.value : 'æœªçŸ¥');
            });
        });
        
        // åˆå§‹åŒ–ï¼šç¡®ä¿ä¸ªäººç¥¨æ˜¯æ¿€æ´»çŠ¶æ€
        const individualTicketType = document.querySelector('.ticket-type input[value="individual"]');
        if (individualTicketType) {
            const parentLabel = individualTicketType.parentElement;
            parentLabel.classList.add('active');
            individualTicketType.checked = true;
        }
        
        // åˆå§‹åŒ–ï¼šæ˜¾ç¤ºä¸ªäººç¥¨æ§åˆ¶é¢æ¿
        showIndividualControls();
        
        console.log('æ‰€æœ‰åŠŸèƒ½åˆå§‹åŒ–å®Œæˆ');
    });
    </script>

    <!-- ========================= æ”¯ä»˜ç¡®è®¤é¡µé¢ç¾åŒ–æ ·å¼ ========================= -->

    <style>
    /* æ”¯ä»˜ç¡®è®¤é¢æ¿ */
.payment-panel {
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
    max-width: 1000px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
}

.payment-panel::before {
    content: '';
    position: absolute;
    top: -50%;
    right: -50%;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle, rgba(102, 126, 234, 0.1) 0%, transparent 70%);
    z-index: 0;
}

.payment-panel > * {
    position: relative;
    z-index: 1;
}

/* æ”¯ä»˜å¤´éƒ¨ */
.payment-panel h2 {
    text-align: center;
    color: #2c3e50;
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 40px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    position: relative;
}

.payment-panel h2::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 4px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 2px;
}

/* æ”¯ä»˜å†…å®¹å¸ƒå±€ */
.payment-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    margin-bottom: 40px;
}

/* è®¢å•æ‘˜è¦å¡ç‰‡ */
.order-summary {
    background: white;
    border-radius: 16px;
    padding: 30px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
}

.order-summary:hover {
    transform: translateY(-5px);
    box-shadow: 0 16px 48px rgba(0, 0, 0, 0.15);
}

.order-summary h3 {
    color: #2c3e50;
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid #e1e5e9;
    position: relative;
}

.order-summary h3::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 50px;
    height: 2px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 2px;
}

/* ç”µå½±ä¿¡æ¯æ‘˜è¦ */
.movie-info-summary {
    display: flex;
    gap: 20px;
    margin-bottom: 25px;
    padding: 20px;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
    border-radius: 12px;
    border: 1px solid rgba(102, 126, 234, 0.1);
}

.movie-poster {
    flex-shrink: 0;
}

.movie-poster img {
    width: 80px;
    height: 120px;
    border-radius: 8px;
    object-fit: cover;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s ease;
}

.movie-poster img:hover {
    transform: scale(1.05);
}

.movie-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.movie-details h4 {
    color: #2c3e50;
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 8px;
}

.movie-details p {
    color: #6c757d;
    font-size: 14px;
    margin-bottom: 5px;
}

/* åº§ä½æ‘˜è¦ */
.seats-summary {
    margin-bottom: 25px;
}

.seats-summary h4 {
    color: #2c3e50;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 15px;
}

#payment-seats-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.payment-seat-item {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 6px 12px;
    border-radius: 15px;
    font-size: 12px;
    font-weight: 500;
    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    transition: all 0.3s ease;
}

.payment-seat-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

/* ä»·æ ¼æ˜ç»† */
.price-breakdown {
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
    border-radius: 12px;
    padding: 20px;
    border: 1px solid #e9ecef;
}

.price-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid #e9ecef;
    font-size: 14px;
    transition: all 0.3s ease;
}

.price-item:hover {
    background: rgba(102, 126, 234, 0.05);
    border-radius: 6px;
    margin: 0 -10px;
    padding: 12px 10px;
}

.price-item:last-child {
    border-bottom: none;
    font-weight: 700;
    font-size: 18px;
    color: #e74c3c;
    padding-top: 15px;
    margin-top: 10px;
    border-top: 2px solid #e9ecef;
}

.price-item.total span:first-child {
    color: #2c3e50;
}

.price-item.total span:last-child {
    color: #e74c3c;
    font-size: 22px;
}

/* å³ä¾§å†…å®¹åŒºåŸŸ */
.payment-method,
.customer-summary {
    background: white;
    border-radius: 16px;
    padding: 30px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    margin-bottom: 30px;
    transition: all 0.3s ease;
}

.payment-method:hover,
.customer-summary:hover {
    transform: translateY(-5px);
    box-shadow: 0 16px 48px rgba(0, 0, 0, 0.15);
}

.payment-method h3,
.customer-summary h3 {
    color: #2c3e50;
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid #e1e5e9;
    position: relative;
}

.payment-method h3::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 50px;
    height: 2px;
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    border-radius: 2px;
}

.customer-summary h3::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 50px;
    height: 2px;
    background: linear-gradient(135deg, #fd7e14 0%, #ffc107 100%);
    border-radius: 2px;
}

/* æ”¯ä»˜æ–¹å¼é€‰é¡¹ */
.payment-options {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.payment-option {
    display: flex;
    align-items: center;
    padding: 18px 20px;
    border: 2px solid #e1e5e9;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    position: relative;
    overflow: hidden;
}

.payment-option::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(32, 201, 151, 0.1) 100%);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
    z-index: 0;
}

.payment-option:hover {
    border-color: #28a745;
    transform: translateX(5px);
    box-shadow: 0 8px 25px rgba(40, 167, 69, 0.2);
}

.payment-option:hover::before {
    transform: scaleX(1);
}

.payment-option.active {
    border-color: #28a745;
    background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(32, 201, 151, 0.1) 100%);
    box-shadow: 0 8px 25px rgba(40, 167, 69, 0.25);
    transform: translateX(5px);
}

.payment-option.active::before {
    transform: scaleX(1);
}

.payment-option input[type="radio"] {
    display: none;
}

.payment-option .payment-icon {
    font-size: 24px;
    margin-right: 15px;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    position: relative;
    z-index: 1;
    transition: all 0.3s ease;
}

.payment-option:hover .payment-icon,
.payment-option.active .payment-icon {
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
}

.payment-option span:last-child {
    color: #2c3e50;
    font-weight: 600;
    font-size: 16px;
    position: relative;
    z-index: 1;
    transition: color 0.3s ease;
}

.payment-option:hover span:last-child,
.payment-option.active span:last-child {
    color: #28a745;
}

/* å®¢æˆ·ä¿¡æ¯ */
#payment-customer-info {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.customer-info-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
    border-radius: 8px;
    border: 1px solid #e9ecef;
    transition: all 0.3s ease;
}

.customer-info-item:hover {
    background: linear-gradient(135deg, rgba(253, 126, 20, 0.05) 0%, rgba(255, 193, 7, 0.05) 100%);
    border-color: #fd7e14;
    transform: translateX(3px);
}

.customer-info-item .label {
    color: #6c757d;
    font-weight: 500;
    font-size: 14px;
}

.customer-info-item .value {
    color: #2c3e50;
    font-weight: 600;
    font-size: 14px;
}

/* æ”¯ä»˜åŠ¨ä½œæŒ‰é’® */
.payment-actions {
    display: flex;
    justify-content: space-between;
    gap: 25px;
    margin-top: 30px;
    padding-top: 30px;
    border-top: 2px solid rgba(255, 255, 255, 0.3);
}

.payment-actions .btn {
    flex: 1;
    padding: 18px 30px;
    font-size: 16px;
    font-weight: 600;
    border-radius: 12px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    border: none;
    cursor: pointer;
}

.payment-actions .btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.payment-actions .btn:hover::before {
    left: 100%;
}

.btn-secondary {
    background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
}

.btn-secondary:hover {
    background: linear-gradient(135deg, #5a6268 0%, #495057 100%);
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
}

.btn-success {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
}

.btn-success:hover {
    background: linear-gradient(135deg, #218838 0%, #1ea080 100%);
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 1024px) {
    .payment-content {
        grid-template-columns: 1fr;
        gap: 30px;
    }
    
    .payment-panel {
        padding: 30px;
    }
    
    .movie-info-summary {
        flex-direction: column;
        text-align: center;
    }
    
    .movie-poster {
        align-self: center;
    }
}

@media (max-width: 768px) {
    .payment-panel {
        padding: 20px;
        margin: 0 10px;
    }
    
    .payment-panel h2 {
        font-size: 24px;
    }
    
    .payment-actions {
        flex-direction: column;
        gap: 15px;
    }
    
    .payment-actions .btn {
        padding: 15px 25px;
        font-size: 14px;
    }
    
    .order-summary,
    .payment-method,
    .customer-summary {
        padding: 20px;
    }
    
    .payment-option {
        padding: 15px;
    }
    
    .payment-option .payment-icon {
        font-size: 20px;
        width: 35px;
        height: 35px;
    }
    
    .payment-option span:last-child {
        font-size: 14px;
    }
}

@media (max-width: 480px) {
    .payment-panel h2 {
        font-size: 20px;
        margin-bottom: 30px;
    }
    
    .movie-info-summary {
        padding: 15px;
    }
    
    .movie-poster img {
        width: 60px;
        height: 90px;
    }
    
    .movie-details h4 {
        font-size: 16px;
    }
    
    .movie-details p {
        font-size: 12px;
    }
    
    #payment-seats-list {
        justify-content: center;
    }
    
    .payment-seat-item {
        font-size: 11px;
        padding: 5px 10px;
    }
    
    .price-item {
        font-size: 13px;
    }
    
    .price-item.total {
        font-size: 16px;
    }
    
    .price-item.total span:last-child {
        font-size: 18px;
    }
}
    </style>

</body>
</html>