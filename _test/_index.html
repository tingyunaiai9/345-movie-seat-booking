<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁîµÂΩ±Èô¢Âú®Á∫øÈÄâÂ∫ßÁ≥ªÁªü</title>
    <link rel="stylesheet" href="_style.css">
</head>
<body>
    <!-- È°µÈù¢Â§¥ÈÉ® -->
    <header class="header">
        <div class="container">
            <h1 class="logo">üé¨ ÁîµÂΩ±Èô¢ÈÄâÂ∫ßÁ≥ªÁªü</h1>
            <nav class="nav">
                <div class="nav-steps">
                    <span class="step active" data-step="config">ÂΩ±ÂéÖÈÖçÁΩÆ</span>
                    <span class="step" data-step="movie">ÁîµÂΩ±ÈÄâÊã©</span>
                    <span class="step" data-step="seat">ÈÄâÂ∫ß</span>
                    <span class="step" data-step="payment">ÊîØ‰ªò</span>
                    <span class="step" data-step="confirm">Á°ÆËÆ§</span>
                </div>
            </nav>
        </div>
    </header>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
    <main class="main">
        <div class="container">
            
            <!-- ÈÖçÁΩÆËßÜÂõæ -->
            <section id="config-view" class="view active">
                <div class="config-panel">
                    <h2>ÂΩ±ÂéÖÈÖçÁΩÆ</h2>
                    <div class="config-section">
                        <h3>ÈÄâÊã©ÂΩ±ÂéÖËßÑÊ®°</h3>
                        <div class="preset-options">
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="small">
                                <span class="preset-info">
                                    <strong>Â∞èÂéÖ</strong>
                                    <span class="preset-details">8Êéí √ó 15Â∫ß = 120‰∏™Â∫ß‰Ωç</span>
                                </span>
                            </label>
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="medium" checked>
                                <span class="preset-info">
                                    <strong>‰∏≠ÂéÖ</strong>
                                    <span class="preset-details">10Êéí √ó 20Â∫ß = 200‰∏™Â∫ß‰Ωç</span>
                                </span>
                            </label>
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="large">
                                <span class="preset-info">
                                    <strong>Â§ßÂéÖ</strong>
                                    <span class="preset-details">12Êéí √ó 25Â∫ß = 300‰∏™Â∫ß‰Ωç</span>
                                </span>
                            </label>
                            <label class="preset-option">
                                <input type="radio" name="cinema-preset" value="custom">
                                <span class="preset-info">
                                    <strong>Ëá™ÂÆö‰πâ</strong>
                                    <span class="preset-details">Ëá™ÂÆö‰πâÂΩ±ÂéÖÂ§ßÂ∞è</span>
                                </span>
                            </label>
                        </div>
                    </div>

                    <div class="config-section custom-config" style="display: none;">
                        <h3>Ëá™ÂÆö‰πâÈÖçÁΩÆ</h3>
                        <div class="custom-inputs">
                            <div class="input-group">
                                <label for="custom-rows">ÊéíÊï∞:</label>
                                <input type="number" id="custom-rows" min="5" max="20" value="10">
                                <span class="input-hint">Âª∫ËÆÆ5-20Êéí</span>
                            </div>
                            <div class="input-group">
                                <label for="custom-seats">ÊØèÊéíÂ∫ß‰ΩçÊï∞:</label>
                                <input type="number" id="custom-seats" min="10" max="30" value="20">
                                <span class="input-hint">Âª∫ËÆÆ10-30Â∫ß</span>
                            </div>
                            <div class="total-info">
                                ÊÄªÂ∫ß‰ΩçÊï∞: <span id="total-seats">200</span>
                            </div>
                        </div>
                    </div>

                    <div class="config-actions">
                        <button class="btn btn-primary" id="next-to-movie">‰∏ã‰∏ÄÊ≠•ÔºöÈÄâÊã©ÁîµÂΩ±</button>
                    </div>
                </div>
            </section>

            <!-- ÁîµÂΩ±ÈÄâÊã©ËßÜÂõæ -->
            <section id="movie-view" class="view">
                <div class="movie-panel">
                    <h2>ÈÄâÊã©ÁîµÂΩ±</h2>
                    <div class="movie-list">
                        <div class="movie-item active" data-movie="luoxiaohei">
                            <img src="../img/LUOXIAOHEI.webp" alt="ÁΩóÂ∞èÈªëÊàòËÆ∞">
                            <div class="movie-info">
                                <h3>ÁΩóÂ∞èÈªëÊàòËÆ∞</h3>
                                <p class="movie-time">2025-6-1 19:30</p>
                                <p class="movie-price">Á•®‰ª∑: ¬•45</p>
                            </div>
                        </div>
                        <div class="movie-item" data-movie="look_back">
                            <img src="../img/OIP.jpg" alt="Ëì¶ÁÑ∂ÂõûÈ¶ñ">
                            <div class="movie-info">
                                <h3>Ëì¶ÁÑ∂ÂõûÈ¶ñ</h3>
                                <p class="movie-time">2025-6-30 21:00</p>
                                <p class="movie-price">Á•®‰ª∑: ¬•50</p>
                            </div>
                        </div>
                        <div class="movie-item" data-movie="love_letter">
                            <img src="../img/OIP.webp" alt="ÊÉÖ‰π¶">
                            <div class="movie-info">
                                <h3>ÊÉÖ‰π¶</h3>
                                <p class="movie-time">2025-5-20 17:20</p>
                                <p class="movie-price">Á•®‰ª∑: ¬•45</p>
                            </div>
                        </div>
                    </div>
                    <div class="movie-actions">
                        <button class="btn btn-secondary" id="back-to-config">‰∏ä‰∏ÄÊ≠•</button>
                        <button class="btn btn-primary" id="next-to-seat">‰∏ã‰∏ÄÊ≠•ÔºöÈÄâÊã©Â∫ß‰Ωç</button>
                    </div>
                </div>
            </section>

            <!-- ÈÄâÂ∫ßËßÜÂõæ -->
            <section id="seat-view" class="view">
                <div class="seat-panel">
                    <div class="seat-header">
                        <h2>ÈÄâÊã©Â∫ß‰Ωç</h2>
                        <div class="ticket-type-selector">
                            <label class="ticket-type active">
                                <input type="radio" name="ticket-type" value="individual" checked>
                                <span>‰∏™‰∫∫Á•®</span>
                            </label>
                            <label class="ticket-type">
                                <input type="radio" name="ticket-type" value="group">
                                <span>Âõ¢‰ΩìÁ•®</span>
                            </label>
                        </div>
                    </div>

                    <div class="seat-content">
                        <!-- Â∑¶‰æßÊéßÂà∂Èù¢Êùø -->
                        <div class="seat-controls">
                            <!-- ‰∏™‰∫∫Á•®ÊéßÂà∂ -->
                            <div class="individual-controls">
                                <div class="customer-info">
                                    <h3>ÂÆ¢Êà∑‰ø°ÊÅØ</h3>
                                    <div class="input-group">
                                        <label for="customer-name">ÂßìÂêç:</label>
                                        <input type="text" id="customer-name" placeholder="ËØ∑ËæìÂÖ•ÂßìÂêç">
                                    </div>
                                    <div class="input-group">
                                        <label for="customer-age">Âπ¥ÈæÑ:</label>
                                        <input type="number" id="customer-age" min="1" max="120" value="25">
                                    </div>
                                    <div class="input-group">
                                        <label for="customer-phone">ÊâãÊú∫Âè∑:</label>
                                        <input type="tel" id="customer-phone" placeholder="ËØ∑ËæìÂÖ•ÊâãÊú∫Âè∑">
                                    </div>
                                </div>

                                <div class="seat-preference">
                                    <h3>ÈÄâÂ∫ßÂÅèÂ•Ω</h3>
                                    <select id="seat-preference">
                                        <option value="auto">Ëá™Âä®Êé®Ëçê</option>
                                        <option value="front">ÂâçÊéí</option>
                                        <option value="middle">‰∏≠Èó¥</option>
                                        <option value="back">ÂêéÊéí</option>
                                    </select>
                                </div>

                                <div class="auto-seat-actions">
                                    <button class="btn btn-auto" id="auto-select-individual">Ëá™Âä®ÈÄâÂ∫ß</button>
                                </div>
                            </div>

                            <!-- Âõ¢‰ΩìÁ•®ÊéßÂà∂ -->
                            <div class="group-controls" style="display: none;">
                                <div class="group-info">
                                    <h3>Âõ¢‰Ωì‰ø°ÊÅØ</h3>
                                    <div class="group-members">
                                        <div class="member-list">
                                            <!-- Âä®ÊÄÅÁîüÊàêÂõ¢‰ΩìÊàêÂëòÂàóË°® -->
                                        </div>
                                        <div class="add-member">
                                            <div class="input-row">
                                                <input type="text" id="member-name" placeholder="ÊàêÂëòÂßìÂêç">
                                                <input type="number" id="member-age" placeholder="Âπ¥ÈæÑ" min="1" max="120">
                                                <button class="btn btn-add" id="add-member">Ê∑ªÂä†</button>
                                            </div>
                                            <div class="member-count">
                                                Â∑≤Ê∑ªÂä† <span id="member-count">0</span> ‰∫∫ (ÊúÄÂ§ö20‰∫∫)
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="group-preference">
                                    <h3>ÈÄâÂ∫ßÂÅèÂ•Ω</h3>
                                    <select id="group-preference">
                                        <option value="auto">Ëá™Âä®Êé®Ëçê</option>
                                        <option value="front">ÂâçÊéí</option>
                                        <option value="middle">‰∏≠Èó¥</option>
                                        <option value="back">ÂêéÊéí</option>
                                    </select>
                                </div>

                                <div class="auto-seat-actions">
                                    <button class="btn btn-auto" id="auto-select-group">Âõ¢‰ΩìËá™Âä®ÈÄâÂ∫ß</button>
                                </div>
                            </div>

                            <!-- ÊâãÂä®ÈÄâÂ∫ßÊ®°ÂºèÂàáÊç¢ -->
                            <div class="manual-controls">
                                <h3>ÊâãÂä®ÈÄâÂ∫ß</h3>
                                <div class="manual-options">
                                    <label class="manual-option">
                                        <input type="radio" name="manual-mode" value="single" checked>
                                        <span>ÂçïÈÄâÊ®°Âºè</span>
                                    </label>
                                    <label class="manual-option">
                                        <input type="radio" name="manual-mode" value="multi">
                                        <span>Â§öÈÄâÊ®°Âºè (Ctrl+ÁÇπÂáª)</span>
                                    </label>
                                </div>
                                <button class="btn btn-clear" id="clear-selection">Ê∏ÖÈô§ÈÄâÊã©</button>
                            </div>

                            <!-- Â∑≤ÈÄâÂ∫ß‰Ωç‰ø°ÊÅØ -->
                            <div class="selected-seats">
                                <h3>Â∑≤ÈÄâÂ∫ß‰Ωç</h3>
                                <div class="selected-list" id="selected-seats-list">
                                    <p class="no-selection">ÊöÇÊú™ÈÄâÊã©Â∫ß‰Ωç</p>
                                </div>
                                <div class="selection-summary">
                                    <div class="summary-item">
                                        <span>Â∑≤ÈÄâÂ∫ß‰ΩçÊï∞:</span>
                                        <span id="selected-count">0</span>
                                    </div>
                                    <div class="summary-item">
                                        <span>ÊÄªÈáëÈ¢ù:</span>
                                        <span id="total-price">¬•0</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ‰∏≠Èó¥CanvasÂ∫ß‰ΩçÂõæÂå∫Âüü -->
                        <div class="seat-canvas-area">
                            <div class="seat-canvas-container">
                                <div class="screen">
                                    <div class="screen-label">Èì∂Âπï</div>
                                </div>
                                <canvas id="cinema-canvas" width="800" height="500">
                                    ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅCanvasÔºåËØ∑ÂçáÁ∫ßÊµèËßàÂô®
                                </canvas>
                                <div class="legend">
                                    <div class="legend-item">
                                        <span class="legend-color available"></span>
                                        <span>ÂèØÈÄâÂ∫ß‰Ωç</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color selected"></span>
                                        <span>Â∑≤ÈÄâÂ∫ß‰Ωç</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color sold"></span>
                                        <span>Â∑≤ÂîÆÂ∫ß‰Ωç</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="legend-color reserved"></span>
                                        <span>Â∑≤È¢ÑËÆ¢</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Â∫ß‰ΩçÊìç‰ΩúÈù¢ÊùøÁßªÂà∞Canvas‰∏ãÊñπ -->
                            <div class="seat-operations-bottom">
                                <div class="operations-grid">
                                    <div class="operations-section">
                                        <h3>Â∫ß‰ΩçÊìç‰Ωú</h3>
                                        <div class="operation-buttons">
                                            <button class="btn btn-reserve" id="reserve-seats">È¢ÑËÆ¢Â∫ß‰Ωç</button>
                                            <button class="btn btn-purchase" id="purchase-seats">Áõ¥Êé•Ë¥≠Á•®</button>
                                        </div>
                                    </div>

                                    <div class="operations-section">
                                        <h3>ÂΩ±ÂéÖÁä∂ÊÄÅ</h3>
                                        <div class="cinema-stats" id="cinema-stats">
                                            <div class="stat-item">
                                                <span>ÂèØÈÄâÂ∫ß‰Ωç:</span>
                                                <span id="available-count">200</span>
                                            </div>
                                            <div class="stat-item">
                                                <span>Â∑≤ÂîÆÂ∫ß‰Ωç:</span>
                                                <span id="sold-count">0</span>
                                            </div>
                                            <div class="stat-item">
                                                <span>Â∑≤È¢ÑËÆ¢:</span>
                                                <span id="reserved-count">0</span>
                                            </div>
                                            <div class="stat-item">
                                                <span>‰∏äÂ∫ßÁéá:</span>
                                                <span id="occupancy-rate">0%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="seat-actions">
                        <button class="btn btn-secondary" id="back-to-movie">‰∏ä‰∏ÄÊ≠•</button>
                        <button class="btn btn-primary" id="next-to-payment" disabled>‰∏ã‰∏ÄÊ≠•ÔºöÊîØ‰ªòÁ°ÆËÆ§</button>
                    </div>
                </div>
            </section>

            <!-- ÊîØ‰ªòËßÜÂõæ -->
            <section id="payment-view" class="view">
                <div class="payment-panel">
                    <h2>ÊîØ‰ªòÁ°ÆËÆ§</h2>
                    <div class="payment-content">
                        <div class="order-summary">
                            <h3>ËÆ¢ÂçïËØ¶ÊÉÖ</h3>
                            <div class="movie-info-summary">
                                <div class="movie-poster">
                                    <img src="https://via.placeholder.com/100x150?text=ÁîµÂΩ±Êµ∑Êä•" alt="ÁîµÂΩ±Êµ∑Êä•">
                                </div>
                                <div class="movie-details">
                                    <h4 id="payment-movie-title">Â§ç‰ªáËÄÖËÅîÁõüÔºöÁªàÂ±Ä‰πãÊàò</h4>
                                    <p id="payment-movie-time">2024-12-25 19:30</p>
                                    <p id="payment-cinema-info">‰∏≠ÂéÖ (10Êéí√ó20Â∫ß)</p>
                                </div>
                            </div>
                            
                            <div class="seats-summary">
                                <h4>ÈÄâ‰∏≠Â∫ß‰Ωç</h4>
                                <div id="payment-seats-list">
                                    <!-- Âä®ÊÄÅÁîüÊàêÂ∫ß‰ΩçÂàóË°® -->
                                </div>
                            </div>

                            <div class="price-breakdown">
                                <div class="price-item">
                                    <span>Á•®‰ª∑:</span>
                                    <span id="unit-price">¬•45</span>
                                </div>
                                <div class="price-item">
                                    <span>Êï∞Èáè:</span>
                                    <span id="ticket-quantity">1</span>
                                </div>
                                <div class="price-item total">
                                    <span>ÊÄªËÆ°:</span>
                                    <span id="final-total">¬•45</span>
                                </div>
                            </div>
                        </div>

                        <div class="payment-method">
                            <h3>ÊîØ‰ªòÊñπÂºè</h3>
                            <div class="payment-options">
                                <label class="payment-option active">
                                    <input type="radio" name="payment-method" value="wechat" checked>
                                    <span class="payment-icon">üí≥</span>
                                    <span>ÂæÆ‰ø°ÊîØ‰ªò</span>
                                </label>
                                <label class="payment-option">
                                    <input type="radio" name="payment-method" value="alipay">
                                    <span class="payment-icon">üí∞</span>
                                    <span>ÊîØ‰ªòÂÆù</span>
                                </label>
                                <label class="payment-option">
                                    <input type="radio" name="payment-method" value="card">
                                    <span class="payment-icon">üí≥</span>
                                    <span>Èì∂Ë°åÂç°</span>
                                </label>
                            </div>
                        </div>

                        <div class="customer-summary">
                            <h3>ÂÆ¢Êà∑‰ø°ÊÅØ</h3>
                            <div id="payment-customer-info">
                                <!-- Âä®ÊÄÅÁîüÊàêÂÆ¢Êà∑‰ø°ÊÅØ -->
                            </div>
                        </div>
                    </div>

                    <div class="payment-actions">
                        <button class="btn btn-secondary" id="back-to-seat">ËøîÂõûÈÄâÂ∫ß</button>
                        <button class="btn btn-success" id="confirm-payment">Á°ÆËÆ§ÊîØ‰ªò</button>
                    </div>
                </div>
            </section>

            <!-- Á°ÆËÆ§ËßÜÂõæ -->
            <section id="confirm-view" class="view">
                <div class="confirm-panel">
                    <div class="success-icon">‚úÖ</div>
                    <h2>Ë¥≠Á•®ÊàêÂäüÔºÅ</h2>
                    
                    <div class="ticket-info">
                        <h3>ÁîµÂ≠êÁ•®ÊçÆ</h3>
                        <div class="ticket-details">
                            <div class="ticket-item">
                                <span>ËÆ¢ÂçïÂè∑:</span>
                                <span id="order-number">-</span>
                            </div>
                            <div class="ticket-item">
                                <span>ÁîµÂΩ±:</span>
                                <span id="confirm-movie-title">-</span>
                            </div>
                            <div class="ticket-item">
                                <span>Âú∫Ê¨°:</span>
                                <span id="confirm-movie-time">-</span>
                            </div>
                            <div class="ticket-item">
                                <span>Â∫ß‰Ωç:</span>
                                <span id="confirm-seats">-</span>
                            </div>
                            <div class="ticket-item">
                                <span>ÈáëÈ¢ù:</span>
                                <span id="confirm-amount">-</span>
                            </div>
                            <div class="ticket-item">
                                <span>Ë¥≠Á•®Êó∂Èó¥:</span>
                                <span id="purchase-time">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="qr-code">
                        <h4>ÂèñÁ•®‰∫åÁª¥Á†Å</h4>
                        <div class="qr-placeholder">
                            <div class="qr-code-box">üì±</div>
                            <p>ËØ∑Âá≠Ê≠§‰∫åÁª¥Á†ÅÂà∞ÂΩ±Èô¢ÂèñÁ•®</p>
                        </div>
                    </div>

                    <div class="confirm-actions">
                        <button class="btn btn-primary" id="new-order">ÁªßÁª≠Ë¥≠Á•®</button>
                        <button class="btn btn-secondary" id="print-ticket">ÊâìÂç∞Á•®ÊçÆ</button>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <!-- Ê∂àÊÅØÊèêÁ§∫ÁªÑ‰ª∂ -->
    <div class="message-container" id="message-container">
        <!-- Âä®ÊÄÅÁîüÊàêÊ∂àÊÅØÊèêÁ§∫ -->
    </div>

    <!-- Âä†ËΩΩÁä∂ÊÄÅÈÅÆÁΩ© -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p class="loading-text">Ê≠£Âú®Âä†ËΩΩ...</p>
        </div>
    </div>

    <!-- Á°ÆËÆ§ÂØπËØùÊ°Ü -->
    <div class="modal-overlay" id="modal-overlay" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 id="modal-title">Á°ÆËÆ§Êìç‰Ωú</h3>
                <button class="modal-close" id="modal-close">√ó</button>
            </div>
            <div class="modal-body">
                <p id="modal-message">Á°ÆÂÆöË¶ÅÊâßË°åÊ≠§Êìç‰ΩúÂêóÔºü</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="modal-cancel">ÂèñÊ∂à</button>
                <button class="btn btn-primary" id="modal-confirm">Á°ÆËÆ§</button>
            </div>
        </div>
    </div>

    <!-- È°µÈù¢Â∫ïÈÉ® -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 ÁîµÂΩ±Èô¢ÈÄâÂ∫ßÁ≥ªÁªü - Âü∫‰∫éCanvasÊäÄÊúØÂÆûÁé∞</p>
        </div>
    </footer>

    <!-- ÂºïÂÖ•JavaScriptÊ®°Âùó -->
    <script src="../js/movieSelector.js"></script>
    <script src="../js/viewController.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/canvas.js"></script>
    <script src="../js/stateManager.js"></script>
    <script src="../js/ui.js"></script>
</body>
</html>